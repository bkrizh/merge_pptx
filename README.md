# Объединение презентаций в одну

## Описание проекта
Этот проект — веб-приложение, разработанное на фреймворке **Django**, которое позволяет пользователям объединять несколько презентаций PowerPoint (в формате `.pptx`) в один документ. Объединение происходит на сервере с использованием библиотеки `win32com.client` для автоматизации работы с Microsoft PowerPoint. Приложение предоставляет удобный интерфейс для загрузки презентаций, просмотра их слайдов, редактирования и создания итогового файла с возможностью добавления титульных и конечных слайдов из шаблонов.
---

## Основные возможности

### 1. Загрузка и управление презентациями
- Поддержка загрузки файлов в формате `.pptx`.
- Редактирование описания загруженных презентаций.
- Просмотр списка презентаций с пагинацией.
- Удаление файлов (доступно только автору или администратору).

### 2. Просмотр превью слайдов
- Генерация изображений слайдов для предварительного просмотра.
- Отображение слайдов в веб-интерфейсе.

### 3. Объединение презентаций
- Выбор нескольких презентаций для объединения.
- Добавление титульного и конечного слайдов из заданных шаблонов (опционально).
- Генерация итоговой презентации на сервере.
- Скачивание объединенного файла.

### 4. Управление шаблонами
- Загрузка и редактирование титульных и конечных слайдов.
- Просмотр превью шаблонов.

### 5. Аутентификация и безопасность
- Регистрация и вход пользователей.
- Разграничение прав доступа (обычные пользователи и администраторы).
- Защита медиафайлов от несанкционированного доступа.

---

## Технические детали
- **Фреймворк:** Django
- **База данных:** SQLite (по умолчанию), с возможностью настройки на другие СУБД, поддерживаемые Django.
- **Обработка презентаций:** Библиотека `win32com.client` для взаимодействия с Microsoft PowerPoint.
- **Многопоточность:** Реализована с использованием блокировок (`threading.Lock`) и условий (`threading.Condition`) для безопасной обработки запросов.
- **Сервер:** WSGI-сервер Waitress для продакшн-среды.
- **Веб-сервер:** Nginx для обслуживания статических и медиафайлов, а также проксирования запросов к Django.

---

## Требования
Для работы приложения необходимо:
- Установленный **Python 3.x** и менеджер пакетов `pip`.
- Установленный **Microsoft PowerPoint** на сервере (для обработки файлов через COM-интерфейс).
- Установленный **Nginx** (для продакшн-среды).

---

## Установка и запуск проекта

### 1. Клонирование репозитория
Склонируйте репозиторий на свой сервер или локальную машину:
```bash
git clone https://github.com/bkrizh/merge_pptx
cd путь/<имя_папки_проекта>
```

### 2. Установка зависимостей
Создайте виртуальное окружение и установите зависимости из файла `requirements.txt`:
```bash
python -m venv venv
source venv/bin/activate  # Для Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 3. Настройка окружения
- Убедитесь, что Microsoft PowerPoint установлен на машине, где будет запущен проект.

### 4. Применение миграций
Инициализируйте базу данных:
```bash
python manage.py migrate
```

### 5. Запуск в режиме разработки
Для тестирования запустите встроенный сервер Django:
```bash
python manage.py runserver
```
Откройте браузер и перейдите по адресу: `http://localhost:8000`. 
Логин админа: admin@admin.ru
Пароль: 123

### 6. Запуск в продакшн-среде
Для продакшн-среды используйте Waitress и Nginx:
1. Запустите сервер Waitress:
   ```bash
   python start_waitress.py
   ```
   По умолчанию сервер будет доступен на `http://localhost:8080`.

2. Настройте Nginx:
   - Установите Nginx на сервер.
   - Скопируйте файл `unionpp_nginx.conf` в директорию конфигураций Nginx.
   - Отредактируйте пути в `unionpp_nginx.conf`, указав актуальные директории для `media` и `static`.
   - Перезапустите Nginx:

3. Проверьте доступность приложения по адресу `http://localhost` или IP-адресу сервера.

---

## Примечания
- **Хранилище:** Для генерации превью слайдов требуется свободное место на диске для временных файлов.
- **Ограничения:** Сервер приложения может работать только на Windows из-за зависимости от PowerPoint.

---